{"ast":null,"code":"import axios from 'axios';\nimport * as actions from './types';\nimport jwt_decode from 'jwt-decode';\nimport { clearErrors, clearSuccess } from './clearErrSuccess';\nimport { loadAccounts } from './accountActions'; // register new user\n\nexport const createUser = (newUser, history) => dispatch => {\n  axios.post('/users/register', newUser).then(res => {\n    dispatch({\n      type: actions.ADD_USER,\n      payload: {\n        new_user: res.data.new_user\n      }\n    });\n    dispatch({\n      type: actions.GET_SUCCESS,\n      payload: {\n        success_msg: res.data.success_msg,\n        type: actions.ADD_USER\n      }\n    });\n    history.push('/users/login');\n  }).catch(err => {\n    dispatch({\n      type: actions.GET_ERRORS,\n      payload: {\n        type: err.response.data.type,\n        errors: err.response.data.errors\n      }\n    });\n    dispatch(clearSuccess());\n  });\n}; // login with email and password\n\nexport const loginUser = (user, history) => dispatch => {\n  axios.post('/users/login', user).then(res => {\n    // save token to localstorage\n    localStorage.setItem('jwtToken', res.data.token); // Set token to Auth header\n\n    if (res.data.token) {\n      // Apply to every request\n      axios.defaults.headers.common['Authorization'] = res.data.token;\n    } // Decode token to get user data\n\n\n    const decoded = jwt_decode(res.data.token); // Set current user\n\n    dispatch({\n      type: actions.SET_CURRENT_USER,\n      payload: decoded\n    });\n  }).then(() => {\n    history.push('/users/dashboard');\n  }).catch(err => {\n    dispatch({\n      type: actions.GET_ERRORS,\n      payload: {\n        type: err.response.data.type,\n        errors: err.response.data.errors\n      }\n    });\n    dispatch(clearSuccess());\n  });\n}; // Login with Google\n\nexport const googleSignIn = (tokenObj, history) => dispatch => {\n  var token = tokenObj.id_token; // decoded user info with JWT token\n\n  var decoded = jwt_decode(token); // set user\n\n  const user = {\n    name: decoded.name,\n    email: decoded.email,\n    imageUrl: decoded.picture // call POST request\n\n  };\n  axios.post('/users/googleLogin', user).then(res => {\n    // save token to localstorage\n    localStorage.setItem('jwtToken', res.data.token); // Apply to every request\n\n    axios.defaults.headers.common['Authorization'] = res.data.token; // decoded user info with JWT token\n\n    var decoded = jwt_decode(res.data.token); // Set current user\n\n    dispatch({\n      type: actions.SET_CURRENT_USER,\n      payload: decoded\n    });\n  }).then(() => {\n    history.push('/users/dashboard');\n  }).then(() => {\n    // load all accounts\n    dispatch(loadAccounts());\n  }).catch(err => {\n    dispatch({\n      type: actions.GET_ERRORS,\n      payload: {\n        type: actions.SET_CURRENT_USER,\n        errors: err.response.data\n      }\n    });\n  });\n}; // Log user out\n\nexport const logoutUser = history => dispatch => {\n  // Remove token from localStorage\n  localStorage.removeItem('jwtToken'); // Remove auth header for future requests\n  // Delete auth header\n\n  delete axios.defaults.headers.common['Authorization']; // Set current user to {} which will set isAuthenticated to false\n\n  dispatch({\n    type: actions.SET_CURRENT_USER,\n    payload: {}\n  });\n  dispatch({\n    type: actions.GET_SUCCESS,\n    payload: {\n      success_msg: 'You are logged out.',\n      type: actions.LOGOUT\n    }\n  });\n  history.push('/users/login');\n}; // Contact Trung\n\nexport const contact = user => dispatch => {\n  dispatch(clearErrors());\n  dispatch(clearSuccess());\n  axios.post('/contact', user).then(res => {\n    dispatch({\n      type: actions.GET_SUCCESS,\n      payload: {\n        success_msg: res.data.success_msg,\n        type: actions.CONTACT_DEVELOPER\n      }\n    });\n  }).catch(err => {\n    dispatch({\n      type: actions.GET_ERRORS,\n      payload: {\n        type: err.response.data.type,\n        errors: err.response.data.errors\n      }\n    });\n  });\n}; // verify email before reset user password\n\nexport const verifyEmail = email => dispatch => {\n  dispatch(clearErrors());\n  dispatch(clearSuccess());\n  axios.post('/users/verify', {\n    email: email\n  }).then(res => {\n    dispatch({\n      type: actions.GET_SUCCESS,\n      payload: {\n        success_msg: res.data.success_msg,\n        type: actions.VERIFY_USER\n      }\n    });\n  }).catch(err => {\n    dispatch({\n      type: actions.GET_ERRORS,\n      payload: {\n        type: actions.VERIFY_USER,\n        errors: err.response.data\n      }\n    });\n  });\n}; // reset user password\n\nexport const resetPassword = (token, history) => dispatch => {\n  axios.get(\"/users/reset/\".concat(token)).then(res => {\n    dispatch({\n      type: actions.PASSWORD_RESET,\n      payload: {\n        user: res.data,\n        resetPasswordToken: res.data.resetPasswordToken,\n        resetPasswordExpires: res.data.resetPasswordExpires\n      }\n    });\n    dispatch(clearSuccess());\n  }).catch(err => {\n    dispatch({\n      type: actions.GET_ERRORS,\n      payload: {\n        type: actions.PASSWORD_RESET,\n        errors: err.response.data\n      }\n    });\n    history.push('/users/forgot');\n  });\n}; // Start reset password by comparing the two, then update!\n\nexport const updatePassword = (user, password, confirm_password, history) => dispatch => {\n  axios.post(\"/users/reset/update_password\", {\n    user: user,\n    password: password,\n    confirm_password: confirm_password\n  }).then(res => {\n    dispatch({\n      type: actions.GET_SUCCESS,\n      payload: {\n        success_msg: res.data.success_msg,\n        type: actions.UPDATE_PASSWORD\n      }\n    });\n    dispatch(clearErrors());\n  }).catch(err => {\n    dispatch({\n      type: actions.GET_ERRORS,\n      payload: {\n        type: err.response.data.type,\n        errors: err.response.data.errors\n      }\n    });\n\n    if (err.response.data.type === actions.PASSWORD_RESET) {\n      history.push('/users/forgot');\n    }\n  });\n}; // delete user account\n\nexport const deleteAccount = history => dispatch => {\n  axios.delete('/users/delete').then(res => {\n    localStorage.removeItem('jwtToken');\n    delete axios.defaults.headers.common['Authorization'];\n    dispatch({\n      type: actions.SET_CURRENT_USER,\n      payload: {}\n    });\n    dispatch({\n      type: actions.GET_SUCCESS,\n      payload: {\n        success_msg: res.data.success_msg,\n        type: actions.DELETE_USER\n      }\n    });\n    history.push('/users/login');\n  }).catch(err => {\n    dispatch({\n      type: actions.GET_ERRORS,\n      payload: {\n        type: actions.DELETE_USER,\n        errors: err.response.data\n      }\n    });\n  });\n};","map":{"version":3,"sources":["/Users/trungvo/javascript-stack/smart-money/client/src/actions/usersActions.js"],"names":["axios","actions","jwt_decode","clearErrors","clearSuccess","loadAccounts","createUser","newUser","history","dispatch","post","then","res","type","ADD_USER","payload","new_user","data","GET_SUCCESS","success_msg","push","catch","err","GET_ERRORS","response","errors","loginUser","user","localStorage","setItem","token","defaults","headers","common","decoded","SET_CURRENT_USER","googleSignIn","tokenObj","id_token","name","email","imageUrl","picture","logoutUser","removeItem","LOGOUT","contact","CONTACT_DEVELOPER","verifyEmail","VERIFY_USER","resetPassword","get","PASSWORD_RESET","resetPasswordToken","resetPasswordExpires","updatePassword","password","confirm_password","UPDATE_PASSWORD","deleteAccount","delete","DELETE_USER"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport * as actions from './types';\nimport jwt_decode from 'jwt-decode';\nimport {clearErrors, clearSuccess} from './clearErrSuccess';\nimport {loadAccounts} from './accountActions';\n\n// register new user\nexport const createUser = (newUser, history) => dispatch => {\n  axios.post('/users/register', newUser)\n    .then(res => {\n      dispatch({\n        type: actions.ADD_USER,\n        payload: {\n          new_user: res.data.new_user\n        }\n      })\n      dispatch({\n        type: actions.GET_SUCCESS,\n        payload: {\n          success_msg: res.data.success_msg,\n          type: actions.ADD_USER\n        }\n      })\n      history.push('/users/login');\n    })\n    .catch(err => {\n      dispatch({\n        type: actions.GET_ERRORS,\n        payload: {\n          type: err.response.data.type,\n          errors: err.response.data.errors\n        }\n      })\n      dispatch(clearSuccess());\n    })\n};\n\n// login with email and password\nexport const loginUser = (user, history) => dispatch => {\n  axios.post('/users/login', user)\n    .then(res => {\n      // save token to localstorage\n      localStorage.setItem('jwtToken', res.data.token);\n      // Set token to Auth header\n      if (res.data.token) {\n        // Apply to every request\n        axios.defaults.headers.common['Authorization'] = res.data.token;\n      }\n      // Decode token to get user data\n      const decoded = jwt_decode(res.data.token);\n      // Set current user\n      dispatch({\n        type: actions.SET_CURRENT_USER,\n        payload: decoded\n      })\n    })\n    .then(() => {\n      history.push('/users/dashboard');\n    })\n    .catch(err => {\n      dispatch({\n        type: actions.GET_ERRORS,\n        payload: {\n          type: err.response.data.type,\n          errors: err.response.data.errors\n        }\n      })\n      dispatch(clearSuccess());\n    })\n}\n\n// Login with Google\nexport const googleSignIn = (tokenObj, history) => dispatch => {\n  var token = tokenObj.id_token;\n  // decoded user info with JWT token\n  var decoded = jwt_decode(token);\n  \n  // set user\n  const user = {\n    name: decoded.name,\n    email: decoded.email,\n    imageUrl: decoded.picture\n  }\n  // call POST request\n  axios.post('/users/googleLogin', user)\n    .then(res => {\n      // save token to localstorage\n      localStorage.setItem('jwtToken', res.data.token);\n      // Apply to every request\n      axios.defaults.headers.common['Authorization'] = res.data.token;\n      // decoded user info with JWT token\n      var decoded = jwt_decode(res.data.token);\n      // Set current user\n      dispatch({\n        type: actions.SET_CURRENT_USER,\n        payload: decoded\n      })\n    })\n    .then(() => {\n      history.push('/users/dashboard');\n    })\n    .then(() => {\n      // load all accounts\n      dispatch(loadAccounts());\n    })\n    .catch(err => {\n      dispatch({\n        type: actions.GET_ERRORS,\n        payload: {\n          type: actions.SET_CURRENT_USER,\n          errors: err.response.data\n        }\n      })\n    })\n};\n\n// Log user out\nexport const logoutUser = (history) => dispatch => {\n  // Remove token from localStorage\n  localStorage.removeItem('jwtToken');\n  // Remove auth header for future requests\n  // Delete auth header\n  delete axios.defaults.headers.common['Authorization'];\n  // Set current user to {} which will set isAuthenticated to false\n  dispatch({\n    type: actions.SET_CURRENT_USER,\n    payload: {}\n  })\n  dispatch({\n    type: actions.GET_SUCCESS,\n    payload: {\n      success_msg: 'You are logged out.',\n      type: actions.LOGOUT\n    }\n  })\n  history.push('/users/login');\n};\n\n// Contact Trung\nexport const contact = (user) => dispatch => {\n  dispatch(clearErrors());\n  dispatch(clearSuccess());\n\n  axios.post('/contact', user)\n    .then(res => {\n      dispatch({\n        type: actions.GET_SUCCESS,\n        payload: {\n          success_msg: res.data.success_msg,\n          type: actions.CONTACT_DEVELOPER\n        }\n      })\n    })\n    .catch(err => {\n      dispatch({\n        type: actions.GET_ERRORS,\n        payload: {\n          type: err.response.data.type,\n          errors: err.response.data.errors\n        }\n      })\n    })\n}\n\n// verify email before reset user password\nexport const verifyEmail = (email) => dispatch => {\n  dispatch(clearErrors());\n  dispatch(clearSuccess());\n\n  axios.post('/users/verify', {email: email})\n    .then(res => {\n      dispatch({\n        type: actions.GET_SUCCESS,\n        payload: {\n          success_msg: res.data.success_msg,\n          type: actions.VERIFY_USER\n        }\n      })\n    })\n    .catch(err => {\n      dispatch({\n        type: actions.GET_ERRORS,\n        payload: {\n          type: actions.VERIFY_USER,\n          errors: err.response.data\n        }\n      })\n    });\n};\n\n// reset user password\nexport const resetPassword = (token, history) => dispatch => {\n  axios.get(`/users/reset/${token}`)\n    .then(res => {\n      dispatch({\n        type: actions.PASSWORD_RESET,\n        payload: {\n          user: res.data,\n          resetPasswordToken: res.data.resetPasswordToken,\n          resetPasswordExpires: res.data.resetPasswordExpires\n        }\n      })\n      dispatch(clearSuccess());\n    })\n    .catch(err => {\n      dispatch({\n        type: actions.GET_ERRORS,\n        payload: {\n          type: actions.PASSWORD_RESET,\n          errors: err.response.data\n        }\n      })\n      history.push('/users/forgot');\n    })\n}\n\n// Start reset password by comparing the two, then update!\nexport const updatePassword = (user, password, confirm_password, history) => dispatch => {\n  axios.post(`/users/reset/update_password`, {\n    user: user,\n    password: password,\n    confirm_password: confirm_password\n  })\n  .then(res => {\n    dispatch({\n      type: actions.GET_SUCCESS,\n      payload: {\n        success_msg: res.data.success_msg,\n        type: actions.UPDATE_PASSWORD\n      }\n    })\n    dispatch(clearErrors());\n  })\n  .catch(err => {\n    dispatch({\n      type: actions.GET_ERRORS,\n      payload: {\n        type: err.response.data.type,\n        errors: err.response.data.errors\n      }\n    })\n    if (err.response.data.type === actions.PASSWORD_RESET) {\n      history.push('/users/forgot');\n    }\n  })\n}\n\n// delete user account\nexport const deleteAccount = (history) => dispatch => {\n  axios.delete('/users/delete')\n    .then(res => {\n      localStorage.removeItem('jwtToken');\n      delete axios.defaults.headers.common['Authorization'];\n      dispatch({\n        type: actions.SET_CURRENT_USER,\n        payload: {}\n      })\n      dispatch({\n        type: actions.GET_SUCCESS,\n        payload: {\n          success_msg: res.data.success_msg,\n          type: actions.DELETE_USER\n        }\n      })\n      history.push('/users/login')\n    })\n    .catch(err => {\n      dispatch({\n        type: actions.GET_ERRORS,\n        payload: {\n          type: actions.DELETE_USER,\n          errors: err.response.data\n        }\n      })\n    })\n}\n\n"]},"metadata":{},"sourceType":"module"}
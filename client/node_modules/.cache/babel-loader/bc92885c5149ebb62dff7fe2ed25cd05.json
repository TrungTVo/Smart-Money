{"ast":null,"code":"var _jsxFileName = \"/Users/trungvo/javascript-stack/smart-money/client/src/layouts/Dashboard.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport NavBar from './NavBar';\nimport Footer from './Footer';\nimport ModalDelete from '../common/ModalDelete';\nimport { Button, Form } from 'react-bootstrap';\nimport * as actions from '../actions/types';\nimport { updateUserAccount } from '../actions/usersActions';\nimport AlertMessage from '../common/AlertMessage';\nimport axios from 'axios';\nimport jwt_decode from 'jwt-decode';\nimport store from '../store';\nimport { logoutUser } from '../actions/usersActions';\n\nclass Dashboard extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      name: ''\n    };\n\n    this.onChange = e => {\n      this.setState({\n        [e.target.id]: e.target.value\n      });\n    };\n\n    this.onSaveInfo = e => {\n      e.preventDefault();\n      const name = this.state.name;\n      this.props.updateUserAccount(name); // Check for token\n\n      if (localStorage.jwtToken) {\n        // Set auth token header auth\n        // Apply to every request\n        axios.defaults.headers.common['Authorization'] = localStorage.jwtToken; // Decode token and get user info and exp\n\n        const decoded = jwt_decode(localStorage.jwtToken);\n        decoded.name = name;\n        console.log(decoded); // set current user\n\n        const user = {\n          name: decoded.name,\n          email: decoded.email,\n          imageUrl: decoded.imageUrl // Set user and isAuthenticated\n\n        };\n        store.dispatch({\n          type: actions.SET_CURRENT_USER,\n          payload: user\n        }); // Check for expired token\n\n        const currentTime = Date.now() / 1000;\n\n        if (decoded.exp < currentTime) {\n          // Logout user\n          store.dispatch(logoutUser()); // Redirect to login\n\n          window.location.href = '/users/login';\n        }\n      }\n    };\n  }\n\n  componentDidMount() {\n    const auth = this.props.auth;\n\n    if (auth.isAuthenticated) {\n      this.setState({\n        name: auth.user.name\n      });\n    }\n  }\n\n  render() {\n    const name = this.state.name;\n    const _this$props = this.props,\n          errors = _this$props.errors,\n          success = _this$props.success;\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, React.createElement(NavBar, {\n      active: \"dashboard\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"container mt-4 mb-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, this.props.auth.isAuthenticated ? // authenticated\n    React.createElement(\"div\", {\n      className: \"row justify-content-around\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-md-7\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"card card-header bg-light\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, \"Dashboard\")), React.createElement(\"div\", {\n      className: \"card card-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: this.props.auth.user.imageUrl !== '' ? this.props.auth.user.imageUrl : \"https://cdn.iconscout.com/icon/free/png-256/account-profile-avatar-man-circle-round-user-30452.png\",\n      alt: \"user-icon\",\n      id: \"profileImg\",\n      width: \"100\",\n      height: \"100\",\n      className: \"img-thumbnail rounded-circle m-auto \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }), \" \", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }), React.createElement(\"h4\", {\n      className: \"text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \"Welcome, \", this.props.auth.user.name), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      className: \"lead text-dark font-weight-bold\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-user-edit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, \"\\xA0\\xA0\"), \"Edit information:\"), success.type === actions.UPDATE_USER && success.success_msg !== '' ? React.createElement(AlertMessage, {\n      variant: 'success',\n      message: success.success_msg,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }) : null, React.createElement(\"form\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form-group row\",\n      style: {\n        'display': 'flex',\n        'alignItems': 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"editName\",\n      className: \"col-md-4 col-form-label text-dark\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, \"Name:\"), React.createElement(\"div\", {\n      className: \"col-md-8 mt-2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"editName\",\n      className: \"form-control\" + (errors.type === actions.UPDATE_USER && errors.errors.error_msg !== '' ? \" is-invalid border border-danger\" : ''),\n      id: \"name\",\n      placeholder: \"Enter new name\",\n      onChange: this.onChange,\n      value: name,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }), errors.type === actions.UPDATE_USER && errors.errors.error_msg !== '' ? React.createElement(\"small\", {\n      className: \"form-text\",\n      style: {\n        color: 'red'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, errors.errors.error_msg) : null))), React.createElement(\"div\", {\n      className: \"form-group row\",\n      style: {\n        'display': 'flex',\n        'alignItems': 'center'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"email\",\n      className: \"col-md-4 col-form-label text-dark\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, \"Email address:\"), React.createElement(\"p\", {\n      className: \"col-md-8 mt-2 text-dark\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, this.props.auth.user.email)), React.createElement(\"p\", {\n      className: \"lead\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"/users/forgot\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, \"Reset password\")), React.createElement(\"div\", {\n      className: \"btn-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, React.createElement(Form, {\n      onSubmit: this.onSaveInfo,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, React.createElement(Button, {\n      variant: \"primary\",\n      className: \"mr-2\",\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, \"Save\")), React.createElement(ModalDelete, {\n      disabled: false,\n      variant: \"danger\",\n      type: actions.DELETE_USER,\n      header: \"Delete account\",\n      body: \"Delete your account will permanently delete all your information and cannot be undone.  Are you sure you want to delete your account?\",\n      buttonText: \"Delete account\",\n      cancelBtn: \"Close\",\n      yesBtn: \"Yes\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }))))) : // not authenticated\n    React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, \"Please sign in to view this!\"), React.createElement(\"a\", {\n      href: \"/users/login\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, \"Back to login\"))), React.createElement(Footer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  auth: state.auth,\n  errors: state.errors,\n  success: state.success\n});\n\nexport default connect(mapStateToProps, {\n  updateUserAccount\n})(Dashboard);","map":{"version":3,"sources":["/Users/trungvo/javascript-stack/smart-money/client/src/layouts/Dashboard.js"],"names":["React","Component","connect","NavBar","Footer","ModalDelete","Button","Form","actions","updateUserAccount","AlertMessage","axios","jwt_decode","store","logoutUser","Dashboard","state","name","onChange","e","setState","target","id","value","onSaveInfo","preventDefault","props","localStorage","jwtToken","defaults","headers","common","decoded","console","log","user","email","imageUrl","dispatch","type","SET_CURRENT_USER","payload","currentTime","Date","now","exp","window","location","href","componentDidMount","auth","isAuthenticated","render","errors","success","UPDATE_USER","success_msg","error_msg","color","DELETE_USER","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport NavBar from './NavBar';\nimport Footer from './Footer';\nimport ModalDelete from '../common/ModalDelete';\nimport {Button, Form} from 'react-bootstrap';\nimport * as actions from '../actions/types';\nimport {updateUserAccount} from '../actions/usersActions';\nimport AlertMessage from '../common/AlertMessage';\nimport axios from 'axios';\nimport jwt_decode from 'jwt-decode';\nimport store from '../store';\nimport { logoutUser } from '../actions/usersActions';\n\n\nclass Dashboard extends Component {\n  state = {\n    name: ''\n  }\n\n  componentDidMount() {\n    const {auth} = this.props;\n    if (auth.isAuthenticated) {\n      this.setState({\n        name: auth.user.name\n      })\n    }\n  }\n\n  onChange = (e) => {\n    this.setState({\n      [e.target.id] : e.target.value\n    })\n  }\n\n  onSaveInfo = (e) => {\n    e.preventDefault();\n    const {name} = this.state;\n    this.props.updateUserAccount(name);\n    // Check for token\n    if (localStorage.jwtToken) {\n      // Set auth token header auth\n      // Apply to every request\n      axios.defaults.headers.common['Authorization'] = localStorage.jwtToken;\n\n      // Decode token and get user info and exp\n      const decoded = jwt_decode(localStorage.jwtToken);\n      decoded.name = name;\n      console.log(decoded)\n      // set current user\n      const user = {\n        name: decoded.name,\n        email: decoded.email,\n        imageUrl: decoded.imageUrl\n      }\n\n      // Set user and isAuthenticated\n      store.dispatch({\n        type: actions.SET_CURRENT_USER,\n        payload: user\n      });\n\n      // Check for expired token\n      const currentTime = Date.now() / 1000;\n      if (decoded.exp < currentTime) {\n        // Logout user\n        store.dispatch(logoutUser());\n\n        // Redirect to login\n        window.location.href = '/users/login';\n      }\n    }\n  }\n\n\n  render() {\n    const {name} = this.state;\n    const {errors, success} = this.props;\n\n    return (\n      <div>\n        <NavBar active=\"dashboard\"/>\n        <div className=\"container mt-4 mb-5\">\n        \n          {\n            this.props.auth.isAuthenticated ? \n            // authenticated\n            <div className=\"row justify-content-around\">\n              <div className=\"col-md-7\" >\n                <div className='card card-header bg-light'>\n                  <h1>Dashboard</h1>\n                </div>\n                <div className='card card-body'>\n                  <img src={this.props.auth.user.imageUrl !== '' ? this.props.auth.user.imageUrl : \"https://cdn.iconscout.com/icon/free/png-256/account-profile-avatar-man-circle-round-user-30452.png\"}\n                    alt=\"user-icon\" id='profileImg'\n                    width=\"100\" height=\"100\" className=\"img-thumbnail rounded-circle m-auto \" /> <br />\n                  \n                  <h4 className='text-center'>Welcome, {this.props.auth.user.name}</h4><br/>\n                  <p className=\"lead text-dark font-weight-bold\">\n                    <i className=\"fas fa-user-edit\"></i><span>&nbsp;&nbsp;</span>Edit information:\n                  </p>\n\n                  {\n                    success.type === actions.UPDATE_USER && success.success_msg !== '' ?\n                      <AlertMessage variant={'success'} message={success.success_msg} /> : null\n                  }\n\n                  <form >\n                    <div className=\"form-group row\" style={{ 'display': 'flex', 'alignItems': 'center' }}>\n                      <label htmlFor=\"editName\" className=\"col-md-4 col-form-label text-dark\">Name:</label>\n                      <div className=\"col-md-8 mt-2\">\n                          <input type=\"editName\" className={\"form-control\" + (errors.type === actions.UPDATE_USER && errors.errors.error_msg !== '' ? \" is-invalid border border-danger\" : '' ) }\n                              id=\"name\" placeholder=\"Enter new name\"\n                              onChange={this.onChange}\n                              value={name} />\n                          {\n                            errors.type === actions.UPDATE_USER && errors.errors.error_msg !== '' ?\n                            <small className=\"form-text\" style={{ color: 'red' }}>\n                              {errors.errors.error_msg}\n                            </small> : null\n                          }\n                      </div>\n                    </div>\n                  </form>\n                  \n                  <div className=\"form-group row\" style={{ 'display': 'flex', 'alignItems': 'center' }}>\n                    <label htmlFor=\"email\" className=\"col-md-4 col-form-label text-dark\">Email address:</label>\n                    <p className=\"col-md-8 mt-2 text-dark\">{this.props.auth.user.email}</p>\n                  </div>\n\n                  <p className=\"lead\"><a href='/users/forgot'>Reset password</a></p>\n                  <div className=\"btn-group\">\n                    <Form onSubmit={this.onSaveInfo}>\n                      <Button variant=\"primary\" className=\"mr-2\" type=\"submit\" >\n                        Save\n                      </Button>\n                    </Form>\n                    <ModalDelete\n                      disabled={false}\n                      variant='danger'\n                      type={actions.DELETE_USER}\n                      header=\"Delete account\"\n                      body=\"Delete your account will permanently delete all your information and cannot be undone. \n                          Are you sure you want to delete your account?\"\n                      buttonText=\"Delete account\"    \n                      cancelBtn=\"Close\"\n                      yesBtn=\"Yes\"\n                    />           \n                  </div>       \n                </div>\n              </div>\n            </div> :\n            // not authenticated\n            <div>\n              <h2>Please sign in to view this!</h2>\n              <a href=\"/users/login\">Back to login</a>\n            </div>\n          }\n          \n        </div>\n        <Footer />\n      </div>\n    )\n  }\n}\n\nconst mapStateToProps = state => ({\n  auth: state.auth,\n  errors: state.errors,\n  success: state.success\n});\n\nexport default connect(mapStateToProps, { updateUserAccount})(Dashboard);\n"]},"metadata":{},"sourceType":"module"}